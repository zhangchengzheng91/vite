# vite 本地调试方式

## 官方推荐

1. 启动 vite 源码

   ```shell
   git clone git@github.com:vitejs/vite.git

   pnpm install

   pnpm run build

   cd package/vite

   pnpm run dev
   ```

1. 修改项目 vite 路径
   ```json
   {
     "dependencies": {
       "vite": "^2.0.0"
     },
     "pnpm": {
       "overrides": {
         "vite": "link:../path/to/vite/packages/vite"
       }
     }
   }
   ```

参考链接：[Vite Contributing Guide](https://github.com/vitejs/vite/blob/main/CONTRIBUTING.md)

## 其他方式

```shell
# clone vite 源码
git clone git@github.com:vitejs/vite.git

# 安装依赖。因为 vite 是用 pnpm 的方式的管理依赖，所以要 pnpm install。
# 如果 pnpm 未安装：npm install pnpm -g
cd vite
pnpm install
# 打包
pnpm run build

# 进入项目目录我，完成基本 vite 配置后，重新配置 vite 启动的 script
# --force 可以强制 vite 不实使用依赖，或者手动删除 node_module/.vite
# https://vitejs.dev/guide/dep-pre-bundling.html#caching
"vite": "vite --force --config build/vite.config.dev.ts"

# 将本地的 vite link 到项目，重启项目
pnpm link /Users/bytedance/source-code/vite/packages/vite && npm run vite

# 调试源码
# 在 vite 源码中做某些改动，重新打包
# 这里注意，不需要重新打包所有的包，只需要打包 vite 即可
cd packages/vite
pnpm run build

# 重启项目
pnpm link /Users/bytedance/source-code/vite/packages/vite && npm run vite

# 终端观察日志
```

## 注意事项

1. 如果使用代理的方式访问 localhost:5173，需要将某些资源做重定向处理，比如 /packages/，/node_modules/ 等
